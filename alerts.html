<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MonitorDash</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
	<!-- Navbar -->
	<nav class="bottom-nav">
    
		<!-- MonitorDash (only for small screens) -->
		<div class="monitor-dash-wrapper">
		  <button class="monitor-dash-btn" onclick="toggleDropdown()">
			<h2>ðŸ“¡MonitorDash</h2>
		  </button>
		  <div class="dropdown-menu" id="dropdownMenu">
			<a href="index.html"><i class="fas fa-chart-line"></i> Dashboard</a>
			<a href="#"><i class="fas fa-desktop"></i> Devices</a>
			<a href="alerts.html"><i class="fas fa-bell"></i> Alerts</a>
			<a href="#"><i class="fas fa-cog"></i> Settings</a>
		  </div>
		</div>
	
		<!-- Full nav links (only for wider screens) -->
		<div class="nav-links">
            <a href="index.html" class="nav-item"><h1>ðŸ“¡MonitorDash</h1></a>
            <a href="index.html" class="nav-item"><i class="fas fa-chart-line"></i>Dashboard</a>
            <a href="#" class="nav-item"><i class="fas fa-desktop"></i>Devices</a>
            <a href="alerts.html" class="nav-item active"><i class="fas fa-bell"></i>Alerts</a>
            <a href="#" class="nav-item"><i class="fas fa-cog"></i>Settings</a>
		</div>
		
	</nav>

	<div class="container device-card">
		<h1>ðŸ”” Active Alerts</h1>

		<div class="filter-buttons">
		<button onclick="filterAlerts('all')">All</button>
		<button onclick="filterAlerts('critical-text')">Critical</button>
		<button onclick="filterAlerts('warning-text')">Warning</button>
		<button onclick="filterAlerts('info-text')">Info</button>
		</div>

		<table id="alertsTable">
		<thead>
			<tr>
			<th>Time</th>
			<th>Device</th>
			<th>Alert Type</th>
			<th>Message</th>
			</tr>
		</thead>
		<tbody>
			<tr class="critical-text">
			<td>2025-04-15 10:12</td>
			<td>Device 192.168.0.20</td>
			<td>Critical</td>
			<td>Device offline</td>
			</tr>
			<tr class="warning-text">
			<td>2025-04-15 10:05</td>
			<td>Device 192.168.0.50</td>
			<td>Warning</td>
			<td>High CPU usage detected</td>
			</tr>
			<tr class="info-text">
			<td>2025-04-15 09:45</td>
			<td>Device 172.18.18.2</td>
			<td>Info</td>
			<td>System rebooted</td>
			</tr>
		</tbody>
		</table>
	</div>
	<div>
		<h2>System Alerts</h2>
		<table id="alertTable">
			<thead>
				<tr>
					<th>Time</th>
					<th>Device</th>
					<th>Type</th>
					<th>Message</th>
				</tr>
			</thead>
			<tbody>
				<tr><td colspan="4">Loading alerts...</td></tr>
			</tbody>
		</table>
	</div>

  <script src="app.js"></script>
  

  <script>
    function filterAlerts(type) {
      const rows = document.querySelectorAll("#alertsTable tbody tr");
      rows.forEach(row => {
        row.style.display = (type === 'all' || row.classList.contains(type)) ? '' : 'none';
      });
    }

	async function fetchAlerts() {
    try {
        const response = await fetch('http://172.18.18.20:5000/alerts');
        const data = await response.json();
        const tbody = document.querySelector('#alertTable tbody');

        tbody.innerHTML = ''; // Clear previous rows

        if (data.alerts.length === 0) {
            tbody.innerHTML = '<tr><td colspan="4">No alerts.</td></tr>';
        } else {
            data.alerts.forEach(alert => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${alert.time}</td>
                    <td>${alert.device}</td>
                    <td>${alert.type}</td>
                    <td>${alert.message}</td>
                `;
                tbody.appendChild(row);
            });
        }
    } catch (error) {
        console.error('Failed to fetch alerts:', error);
    }
}

// Run on page load and update every 5 seconds
window.onload = () => {
    fetchAlerts();
    setInterval(fetchAlerts, 1000);
};
  </script>
</body>
</html>
